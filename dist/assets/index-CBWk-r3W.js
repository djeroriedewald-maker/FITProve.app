import{r as c,s as F,j as e}from"./index-BZn6MCEi.js";import{p as ue}from"./assets-lhZkEq0c.js";import{W as J}from"./WorkoutCard-BCFfZEe3.js";async function C(a){var r,o;const n=await fetch(a,{cache:"no-store"});if(!n.ok)throw new Error(`HTTP ${n.status} @ ${a}`);try{return await n.json()}catch(i){if((o=(r=import.meta)==null?void 0:r.env)!=null&&o.DEV)try{const m=await n.clone().text();console.error("JSON parse failed for",a,"first bytes:",m.slice(0,120))}catch{}throw i}}const v=a=>(a||"").trim().replace(/\/manifest\.json$/i,"").replace(/\/+$/g,"");function se(a,n){const r=v(a),o=n.replace(/^\/+/,"");if(/^https?:\/\//i.test(r))try{const i=new URL(r.endsWith("/")?r:r+"/");return new URL(o,i).toString()}catch{return`${r}/${o}`}return`${r}/${o}`}const Y=a=>se(a,"manifest.json"),U=(a,n)=>se(a,`chunk-${String(n).padStart(3,"0")}.json`),ae="/data/workouts/v20250906",me="/data/workouts/v20250905";async function Z(a,n,r){var x,w,b,k,B,M,$,A;const o=v(a||n),i=`${o.replace(/\/+$/g,"")}/index.json`;(w=(x=import.meta)==null?void 0:x.env)!=null&&w.DEV&&console.log(`[loader] resolveBase(${r})`,{basePref:a,base:o,idxUrl:i});try{const p=await C(i),g=p&&(p[`${r}_latest`]||p.latest);if(g){const h=await C(`${o.replace(/\/+$/g,"")}/${g}/manifest.json`);let f=K(o,h);try{const j=U(f.chunkBase,0);if(!(await fetch(j,{method:"HEAD"})).ok){const S=v(`${o}/${h.version||g}`);f={manifest:h,chunkBase:S}}}catch{const j=v(`${o}/${h.version||g}`);f={manifest:h,chunkBase:j}}return(k=(b=import.meta)==null?void 0:b.env)!=null&&k.DEV&&console.log(`[loader] manifest(${r})`,{version:h==null?void 0:h.version,chunkBase:f.chunkBase}),f}}catch{}try{const p=await C(Y(o));let g=K(o,p);try{(await fetch(U(g.chunkBase,0),{method:"HEAD"})).ok||(g={manifest:p,chunkBase:v(`${o}/${p.version||""}`)})}catch{g={manifest:p,chunkBase:v(`${o}/${p.version||""}`)}}return(M=(B=import.meta)==null?void 0:B.env)!=null&&M.DEV&&console.log(`[loader] alias-manifest(${r})`,{version:p==null?void 0:p.version,chunkBase:g.chunkBase}),g}catch{}const m=await C(Y(n)),l=K(n,m);return(A=($=import.meta)==null?void 0:$.env)!=null&&A.DEV&&console.log(`[loader] fallback-manifest(${r})`,{version:m==null?void 0:m.version,chunkBase:l.chunkBase}),l}function K(a,n){let r=a;const o=n.basePath,i=n.version,m=/^https?:\/\//i.test(a);if(m&&i){const l=new RegExp(`/${i}$`).test(v(a));return{manifest:n,chunkBase:v(l?a:`${a}/${i}`)}}return!m&&i&&o&&/^(\.\/)?v\d{8,}/i.test(o)&&new RegExp(`/${i}$`).test(a)?{manifest:n,chunkBase:v(a)}:(o?/^https?:\/\//i.test(o)||o.startsWith("/")?r=v(o):r=v(`${a}/${o.replace(/^\.\/?/,"")}`):i&&(r=v(`${a}/${i}`)),{manifest:n,chunkBase:r})}async function he(a,n,r){return Z(n,ae,a)}async function*xe(){var r,o,i,m;const{manifest:a,chunkBase:n}=await Z((o=(r=import.meta)==null?void 0:r.env)==null?void 0:o.VITE_WORKOUTS_BASE,ae,"workouts");for(let l=0;l<a.chunks;l++){const x=U(n,l);(m=(i=import.meta)==null?void 0:i.env)!=null&&m.DEV&&console.log("[loader] fetch chunk",x),yield await C(x)}}async function*pe(){var o,i,m,l,x,w;const a=((i=(o=import.meta)==null?void 0:o.env)==null?void 0:i.VITE_EXERCISES_BASE)||((l=(m=import.meta)==null?void 0:m.env)==null?void 0:l.VITE_WORKOUTS_BASE),{manifest:n,chunkBase:r}=await Z(a,me,"exercises");for(let b=0;b<n.chunks;b++){const k=U(r,b);(w=(x=import.meta)==null?void 0:x.env)!=null&&w.DEV&&console.log("[loader] fetch chunk",k),yield await C(k)}}const{primary:ge,fallback:ee}=ue("workout.webp"),te={all:"Alle regioâ€™s",onderlichaam:"Onderlichaam",romp:"Romp",armen:"Armen",rug:"Rug",benen:"Benen"},ve={onderlichaam:new Set(["glutes","gluteus","hips","hip flexors","adductors","abductors","quadriceps","quads","hamstrings","calves","soleus","tibialis"]),romp:new Set(["abdominals","abs","core","obliques","transverse abdominis","pelvic floor","serratus"]),armen:new Set(["biceps","triceps","forearms"]),rug:new Set(["back","upper back","lats","latissimus dorsi","traps","trapezius","rhomboids","erector spinae","lower back"]),benen:new Set(["quadriceps","quads","hamstrings","calves","soleus","tibialis"])};function fe(a,n){if(n==="all")return!0;const r=[...a.primaryMuscles??[],...a.secondaryMuscles??[]].map(i=>i.toLowerCase()),o=ve[n];return r.some(i=>o.has(i))}function y(...a){return a.filter(Boolean).join(" ")}function we(){const[a,n]=c.useState("home"),[r,o]=c.useState(null),[i,m]=c.useState(null);c.useEffect(()=>{let t=!0;return(async()=>{try{const s=[];for await(const d of pe()){if(!t)return;s.push(...d)}if(!t)return;o(s)}catch(s){if(console.error(s),!t)return;m((s==null?void 0:s.message)??"Kon de exercise library niet laden."),o([])}})(),()=>{t=!1}},[]);const[l,x]=c.useState({equipment:"any",duration:"any"}),[w,b]=c.useState(0),[k,B]=c.useState([]),[M,$]=c.useState(!1),[A,p]=c.useState();c.useEffect(()=>{if(a!=="workout-library")return;let t=!0;return $(!0),p(void 0),b(0),B([]),(async()=>{try{let s=0;for await(const d of xe()){if(!t)return;B(u=>[...u,...d]),b(++s)}}catch(s){if(!t)return;p((s==null?void 0:s.message)??"Kon workouts niet laden.")}finally{if(!t)return;$(!1)}})(),()=>{t=!1}},[a]);const g=c.useMemo(()=>{const t=(l.q??"").trim().toLowerCase();return k.filter(s=>{const d=!t||s.title.toLowerCase().includes(t),u=!l.goal||(s.goal??"").toLowerCase()===l.goal.toLowerCase(),L=!l.level||(s.level??"").toLowerCase()===l.level.toLowerCase(),E=s.equipment??[],V=E.length>0&&E.every(W=>W==="bodyweight"),O=l.equipment==="any"?!0:l.equipment==="without"?V:!V,D=l.duration==="any"?!0:String(s.durationMin??"")===l.duration;return d&&u&&L&&O&&D})},[k,l]),[h,f]=c.useState({exercisesInLibrary:0,workoutsInLibrary:0,workoutsDone:0,badgesEarned:0,loading:!0});c.useEffect(()=>{f(t=>({...t,exercisesInLibrary:(r??[]).length}))},[r]),c.useEffect(()=>{let t=!0;return(async()=>{try{const s="https://jajfjspotcwxllkeuysn.supabase.co/storage/v1/object/public/workouts/v20250906",{manifest:d}=await he("workouts",s);if(!t)return;f(u=>({...u,workoutsInLibrary:d.total,loading:!1}))}catch{if(!t)return;f(s=>({...s,workoutsInLibrary:0,loading:!1}))}})(),()=>{t=!1}},[]),c.useEffect(()=>{let t=!0;return(async()=>{try{await F.auth.getUser();let s=0;try{const{count:u}=await F.from("workout_sessions").select("id",{count:"exact"}).eq("status","completed");s=u??0}catch{s=0}let d=0;try{const{count:u}=await F.from("user_badges").select("id",{count:"exact"});d=u??0}catch{d=0}if(!t)return;f(u=>({...u,workoutsDone:s,badgesEarned:d}))}catch{if(!t)return}})(),()=>{t=!1}},[]);const[j,P]=c.useState(""),[S,re]=c.useState("all"),[_,ne]=c.useState("all"),[R,oe]=c.useState(!1),[I,ie]=c.useState("all"),le=c.useMemo(()=>{const t=new Set;return(r??[]).forEach(s=>{var d;return(d=s.equipment)==null?void 0:d.forEach(u=>t.add(u))}),["all",...Array.from(t).sort((s,d)=>s.localeCompare(d))]},[r]),Q=c.useMemo(()=>{const t=j.trim().toLowerCase();return(r??[]).filter(s=>{var O,D;const d=!t||s.name.toLowerCase().includes(t)||(s.category??"").toLowerCase().includes(t)||s.primaryMuscles.some(W=>W.toLowerCase().includes(t))||(s.secondaryMuscles??[]).some(W=>W.toLowerCase().includes(t)),u=_==="all"?!0:s.equipment.includes(_),L=!0,E=!R||(((D=(O=s.media)==null?void 0:O.videos)==null?void 0:D.length)??0)>0,V=fe(s,I);return d&&u&&L&&E&&V}).slice(0,100).map(s=>{var u,L,E;const d=new Set([...s.equipment??[],...(s.primaryMuscles??[]).slice(0,2)]);return(((L=(u=s.media)==null?void 0:u.videos)==null?void 0:L.length)??0)>0&&d.add("video"),{id:s.id,title:s.name,tags:Array.from(d),thumbnail:(E=s.media)==null?void 0:E.thumbnail}})},[r,j,S,_,R,I]),X=c.useMemo(()=>g.map(t=>{var s;return{id:t.id,title:t.title,duration:t.durationMin,level:t.level,tags:[...t.equipment??[],...t.goal?[t.goal]:[],...t.level?[t.level]:[]],thumbnail:((s=t.media)==null?void 0:s.cover)??void 0}}),[g]),q="h-10 text-sm rounded-lg border px-3 outline-none transition bg-white text-zinc-900 border-zinc-300 dark:bg-zinc-900 dark:text-zinc-100 dark:border-zinc-700 placeholder:text-zinc-500 dark:placeholder:text-zinc-400 focus:border-orange-500 focus:ring-2 focus:ring-orange-500/30",N=q+" pr-8",ce=t=>y("px-3 py-2 rounded-xl border text-sm transition",t?"border-orange-600 bg-orange-600/10 text-orange-600":"border-zinc-300 text-zinc-700 dark:border-zinc-700 dark:text-zinc-300 bg-transparent"),z="border-orange-500 bg-orange-500/10",de=a==="home"?"Workouts":a==="exercise-library"?"Oefeningen":a==="workout-library"?"Workout Library":a==="my"?"My Workouts":"Workouts";return e.jsxs("div",{className:"px-4 py-4 max-w-3xl mx-auto",children:[a==="home"&&e.jsx("div",{className:"mb-4 overflow-hidden rounded-2xl border border-zinc-200 dark:border-zinc-800",children:e.jsx("img",{src:ge,alt:"Workout",className:"w-full h-40 sm:h-56 object-cover",loading:"lazy",decoding:"async",draggable:!1,onError:t=>{const s=t.currentTarget;s.src!==ee&&(s.src=ee||"/images/hero.svg")}})}),e.jsx("h1",{className:"text-2xl font-bold mb-3",children:de}),e.jsx("div",{className:"mb-3 flex gap-2 flex-wrap",children:["home","exercise-library","workout-library","my","badges","help"].map(t=>e.jsx("button",{onClick:()=>n(t),className:ce(a===t),children:t==="home"?"Home":t==="exercise-library"?"Exercise Library":t==="workout-library"?"Workout Library":t==="my"?"My Workouts":t==="badges"?"Badges":"Help"},t))}),a==="home"&&e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(T,{title:"Oefeningen",value:h.exercisesInLibrary,hint:"in library",loading:r===null}),e.jsx(T,{title:"Workouts",value:h.workoutsInLibrary,hint:"in library",loading:h.loading}),e.jsx(T,{title:"Gedaan",value:h.workoutsDone,hint:"workouts",loading:h.loading}),e.jsx(T,{title:"Badges",value:h.badgesEarned,hint:"verdiend",loading:h.loading})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(H,{label:"Met video",value:(r??[]).filter(t=>{var s,d;return(((d=(s=t.media)==null?void 0:s.videos)==null?void 0:d.length)??0)>0}).length}),e.jsx(H,{label:"Materiaaltypes",value:new Set((r??[]).flatMap(t=>t.equipment??[])).size}),e.jsx(H,{label:"Spiergroepen",value:new Set((r??[]).flatMap(t=>[...t.primaryMuscles??[],...t.secondaryMuscles??[]])).size})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(G,{title:"Exercise Library",text:"Zoek losse oefeningen op naam, spiergroep, materiaal of alleen met video.",onClick:()=>n("exercise-library")}),e.jsx(G,{title:"Workout Library",text:"Complete workouts met filters op doel, niveau, materiaal en duur.",onClick:()=>n("workout-library")}),e.jsx(G,{title:"My Workouts",text:"Bekijk je sessie-historie en voortgang.",onClick:()=>n("my")})]}),e.jsxs("p",{className:"text-[11px] text-zinc-500 dark:text-zinc-500",children:["Bases: ",e.jsx("code",{children:"VITE_EXERCISES_BASE"})," â†’ exercises, ",e.jsx("code",{children:"VITE_WORKOUTS_BASE"})," â†’ workouts."]})]}),a==="exercise-library"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 w-full flex-wrap",children:[e.jsx("input",{value:j,onChange:t=>P(t.target.value),placeholder:"Zoek exercise...",className:y(q,j&&z,"flex-1 sm:w-64"),"aria-label":"Zoek"}),e.jsx("select",{value:S,onChange:t=>re(t.target.value),className:y(N,S!=="all"&&z),"aria-label":"Filter op niveau",children:e.jsx("option",{value:"all",children:"Alle niveaus"})}),e.jsx("select",{value:_,onChange:t=>ne(t.target.value),className:y(N,_!=="all"&&z),"aria-label":"Filter op materiaal",children:le.map(t=>e.jsx("option",{value:t,children:t==="all"?"Alle equipment":t},t))}),e.jsx("select",{value:I,onChange:t=>ie(t.target.value),className:y(N,I!=="all"&&z),"aria-label":"Filter op regio",children:Object.keys(te).map(t=>e.jsx("option",{value:t,children:te[t]},t))}),e.jsxs("label",{className:y(q,"flex items-center gap-2 cursor-pointer select-none w-auto px-3",R&&z),title:"Toon alleen oefeningen met video",children:[e.jsx("input",{type:"checkbox",className:"accent-orange-500 h-4 w-4",checked:R,onChange:t=>oe(t.target.checked),"aria-label":"Alleen met video"}),e.jsx("span",{children:"Alleen met video"})]})]}),r===null&&e.jsx("div",{className:"mt-4 grid gap-3",children:Array.from({length:6}).map((t,s)=>e.jsxs("div",{className:"animate-pulse rounded-xl border border-zinc-200 dark:border-zinc-800 p-4",children:[e.jsx("div",{className:"h-4 w-1/3 bg-zinc-200 dark:bg-zinc-800 rounded"}),e.jsx("div",{className:"h-3 w-1/4 bg-zinc-200 dark:bg-zinc-800 mt-2 rounded"})]},s))}),r!==null&&i&&e.jsxs("p",{className:"mt-4 text-sm text-red-600 dark:text-red-400",children:["Fout bij laden: ",i]}),r!==null&&!i&&e.jsxs("div",{className:"mt-4 grid gap-3",children:[Q.map(t=>e.jsx(J,{id:t.id,title:t.title,duration:t.duration,level:t.level,tags:t.tags,thumbnail:t.thumbnail},t.id)),Q.length===0&&e.jsx("p",{className:"opacity-70",children:"Geen resultaten. Pas je filters aan."})]})]}),a==="workout-library"&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("input",{value:l.q??"",onChange:t=>x(s=>({...s,q:t.target.value})),placeholder:"Zoek workout...",className:y(q,(l.q??"")!==""&&z,"flex-1 sm:w-64"),"aria-label":"Zoek workout"}),e.jsxs("select",{value:l.goal??"",onChange:t=>x(s=>({...s,goal:t.target.value||void 0})),className:N,"aria-label":"Filter op doel",children:[e.jsx("option",{value:"",children:"Alle doelen"}),e.jsx("option",{value:"strength",children:"Kracht"}),e.jsx("option",{value:"conditioning",children:"Conditioning"}),e.jsx("option",{value:"fat_loss",children:"Vetverlies"}),e.jsx("option",{value:"mobility",children:"Mobiliteit"})]}),e.jsxs("select",{value:l.level??"",onChange:t=>x(s=>({...s,level:t.target.value||void 0})),className:N,"aria-label":"Filter op niveau",children:[e.jsx("option",{value:"",children:"Alle niveaus"}),e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Gevorderd"}),e.jsx("option",{value:"advanced",children:"Advanced"})]}),e.jsxs("select",{value:l.equipment??"any",onChange:t=>x(s=>({...s,equipment:t.target.value})),className:N,"aria-label":"Materiaal",children:[e.jsx("option",{value:"any",children:"Alle materialen"}),e.jsx("option",{value:"with",children:"Met materiaal"}),e.jsx("option",{value:"without",children:"Zonder materiaal (bodyweight)"})]}),e.jsxs("select",{value:l.duration??"any",onChange:t=>x(s=>({...s,duration:t.target.value})),className:N,"aria-label":"Duur",children:[e.jsx("option",{value:"any",children:"Alle tijden"}),e.jsx("option",{value:"20",children:"20 min"}),e.jsx("option",{value:"30",children:"30 min"}),e.jsx("option",{value:"45",children:"45 min"}),e.jsx("option",{value:"60",children:"60 min"})]}),e.jsx("button",{className:y(q,"px-3 h-10"),onClick:()=>x({equipment:"any",duration:"any"}),children:"Reset"})]}),A&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400",children:["Error: ",A]}),M&&w===0?e.jsx("div",{className:"grid gap-3",children:Array.from({length:6}).map((t,s)=>e.jsx("div",{className:"h-24 rounded-2xl bg-zinc-100 dark:bg-zinc-800 animate-pulse"},s))}):X.length?e.jsx("div",{className:"grid gap-3",children:X.map(t=>e.jsx(J,{id:t.id,title:t.title,duration:t.duration,level:t.level,tags:t.tags,thumbnail:t.thumbnail},t.id))}):e.jsx("div",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Geen workouts gevonden. Pas je filters aan."})]}),a==="my"&&e.jsx(be,{}),a==="badges"&&e.jsx("div",{className:"mt-6 opacity-80",children:e.jsx("p",{children:"Badges-overzicht komt hier."})}),a==="help"&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Help"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsxs("li",{children:[e.jsx("b",{children:"Exercise Library"}),": losse oefeningen vinden (spier, materiaal, video)."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Workout Library"}),": complete workouts met doel/niveau/materiaal/duur."]}),e.jsxs("li",{children:[e.jsx("b",{children:"My Workouts"}),": sessie-historie na voltooien."]})]})]})]})}function T({title:a,value:n,hint:r,loading:o}){return e.jsxs("div",{className:"rounded-2xl border border-zinc-200 dark:border-zinc-800 p-4 bg-white/70 dark:bg-zinc-900/60",children:[e.jsx("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:a}),o?e.jsx("div",{className:"mt-1 h-7 w-16 animate-pulse rounded bg-zinc-200 dark:bg-zinc-800"}):e.jsx("div",{className:"text-2xl font-semibold mt-1",children:n}),r&&e.jsx("div",{className:"text-[11px] text-zinc-500 mt-1",children:r})]})}function H({label:a,value:n}){return e.jsxs("div",{className:"rounded-xl border border-zinc-200 dark:border-zinc-800 p-3 bg-white/60 dark:bg-zinc-900/50",children:[e.jsx("div",{className:"text-[11px] text-zinc-500",children:a}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:n})]})}function G({title:a,text:n,onClick:r}){return e.jsxs("button",{type:"button",onClick:r,className:`text-left rounded-2xl border border-zinc-200 dark:border-zinc-800 p-4 transition\r
                 bg-white hover:bg-zinc-50 dark:bg-zinc-900 dark:hover:bg-zinc-800/80 focus:outline-none\r
                 focus:ring-2 focus:ring-orange-500/30`,children:[e.jsx("div",{className:"font-semibold",children:a}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mt-1",children:n})]})}function be(){const[a,n]=c.useState(null);return c.useEffect(()=>{let r=!0;return(async()=>{try{const{data:o,error:i}=await F.from("workout_sessions").select("id, workout_id, workout_title, status, started_at, completed_at").order("started_at",{ascending:!1}).limit(5);if(i)throw i;r&&n(o)}catch{r&&n([])}})(),()=>{r=!1}},[]),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Laatste sessies"}),e.jsx("a",{href:"/modules/workouts/logs",className:"text-sm underline decoration-orange-500 decoration-2 underline-offset-2 hover:opacity-80",children:"Volledige geschiedenis"})]}),a===null?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 animate-pulse rounded-2xl bg-muted/40"}),e.jsx("div",{className:"h-16 animate-pulse rounded-2xl bg-muted/40"})]}):a.length===0?e.jsx("div",{className:"rounded-2xl border bg-card p-6 text-center text-sm text-muted-foreground",children:"Nog geen sessies opgeslagen. Start een workout via de library."}):e.jsx("div",{className:"space-y-3",children:a.map(r=>e.jsx("a",{href:`/modules/programs/${encodeURIComponent(r.workout_id)}?sid=${r.id}`,className:"block rounded-2xl border bg-card p-4 shadow-sm hover:bg-accent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold",children:r.workout_title??"Workout"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[new Date(r.started_at).toLocaleString(),r.completed_at?" â€¢ voltooid":" â€¢ actief"]})]}),e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${r.status==="completed"?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400":"bg-amber-500/10 text-amber-600 dark:text-amber-400"}`,children:r.status})]})},r.id))})]})}export{we as default};
